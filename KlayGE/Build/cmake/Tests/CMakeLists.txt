DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/RenderToTexture/RenderToTextureMS2Test.dds" "942271432b537910e7641ed54127c089013ec8ce")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/RenderToTexture/RenderToTextureMS4Test.dds" "c88665cb9bd306e0f56b2bae7211fd37526a31e4")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/RenderToTexture/RenderToTextureMS8Test.dds" "ab7ebba0eca47348e7daa0d1fac01b4ccd10d677")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/RenderToTexture/RenderToTextureTest.dds" "1a0f45e5edf0c52932f7b47893d6a292e11346e2")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/ResLoader/Test.7z" "f128c4a3861d69279b2b43c885bf107b2dd4aaf0")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/ResLoader/Test.txt" "e4c991063598ea62ed6fa5f6164565ca6e2fccb9")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/ResLoader/TestPassword.7z" "3b300e251ec5181ba03b24e57e478cab9d347471")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/leaf_v3_green_tex.dds" "c180e28392be0f6d9b8e429c416392923d9e7139")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/leaf_v3_green_tex_bc2.dds" "3e4095b5252662319898cabd4011f0d9d50faad8")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/leaf_v3_green_tex_bc3.dds" "f596c895a2248b7650486adf32b911b5380c6f04")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/leaf_v3_green_tex_bc7.dds" "7c55686ca97660ca3c057437e37c596c5455449b")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/Lenna.dds" "292f31bcc45712989e1f3593835d5129bba8c0ac")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/Lenna_bc1.dds" "1c236d9d06364fbeb03a274802b086d782a9609b")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/Lenna_bc7.dds" "90a50b2ed010a9d29ebf36d7c2dd5f93ed1d44c0")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/memorial.dds" "cee51491891a16bf5cc39eb1fd54fff0b0ae0683")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/memorial_bc6u.dds" "23609a1794f2c95b643c12282728a9865988fc47")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/uffizi_probe.dds" "f614b2494da0b649e0c14a2648213a3c95da8bcc")
DOWNLOAD_DEPENDENCY("KlayGE/Tests/media/uffizi_probe_bc6s.dds" "f3b28807c56a1c8b99d1fe8d831d6a653539abd1")

SET(SOURCE_FILES
	${KLAYGE_PROJECT_DIR}/Tests/src/BlitterTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/CTHashTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/EncodeDecodeTexTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/KlayGETests.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/MathTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/RenderToTextureTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/ResLoaderTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/SIMDMathTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/StreamOutputTest.cpp
)
SET(HEADER_FILES
	${KLAYGE_PROJECT_DIR}/Tests/src/KlayGETests.hpp
)
SET(RESOURCE_FILES "")
SET(EFFECT_FILES
	${KLAYGE_PROJECT_DIR}/Tests/media/RenderToTexture/RenderToTextureTest.fxml
	${KLAYGE_PROJECT_DIR}/Tests/media/StreamOutput/StreamOutputTest.fxml
)
SET(POST_PROCESSORS "")
SET(UI_FILES "")

SOURCE_GROUP("Source Files" FILES ${SOURCE_FILES})
SOURCE_GROUP("Header Files" FILES ${HEADER_FILES})
SOURCE_GROUP("Resource Files" FILES ${RESOURCE_FILES})
SOURCE_GROUP("Effect Files" FILES ${EFFECT_FILES})
SOURCE_GROUP("Post Processors" FILES ${POST_PROCESSORS})
SOURCE_GROUP("UI Files" FILES ${UI_FILES})

SET(EXE_NAME "Tests")

INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../External/googletest/include)
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/include)
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/Core/Include)
INCLUDE_DIRECTORIES(${EXTRA_INCLUDE_DIRS})
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../External/googletest/lib/${KLAYGE_PLATFORM_NAME})
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/lib/${KLAYGE_PLATFORM_NAME})
IF(KLAYGE_PLATFORM_DARWIN OR KLAYGE_PLATFORM_LINUX)
	LINK_DIRECTORIES(${KLAYGE_BIN_DIR})
ELSE()
	LINK_DIRECTORIES(${KLAYGE_OUTPUT_DIR})
ENDIF()
IF(KLAYGE_PLATFORM_ANDROID OR KLAYGE_PLATFORM_IOS)
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../glloader/lib/${KLAYGE_PLATFORM_NAME})
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../kfont/lib/${KLAYGE_PLATFORM_NAME})
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../MeshMLLib/lib/${KLAYGE_PLATFORM_NAME})
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../External/7z/lib/${KLAYGE_PLATFORM_NAME})
ENDIF()
LINK_DIRECTORIES(${EXTRA_LINKED_DIRS})

ADD_EXECUTABLE(${EXE_NAME} "" ${SOURCE_FILES} ${HEADER_FILES} ${RESOURCE_FILES} ${EFFECT_FILES} ${POST_PROCESSORS} ${UI_FILES})

SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES
	PROJECT_LABEL ${EXE_NAME}
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME ${EXE_NAME}${KLAYGE_OUTPUT_SUFFIX})

IF(KLAYGE_PLATFORM_DARWIN)
	SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES
		RUNTIME_OUTPUT_DIRECTORY ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_DEBUG ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_RELEASE ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_RELWITHDEBINFO ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_MINSIZEREL ${KLAYGE_BIN_DIR}
	)
ENDIF()

SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES}
	debug gtest${KLAYGE_OUTPUT_SUFFIX}_d optimized gtest${KLAYGE_OUTPUT_SUFFIX}
	debug gtest_main${KLAYGE_OUTPUT_SUFFIX}_d optimized gtest_main${KLAYGE_OUTPUT_SUFFIX}
	debug KlayGE_Core${KLAYGE_OUTPUT_SUFFIX}_d optimized KlayGE_Core${KLAYGE_OUTPUT_SUFFIX}
	debug KFL${KLAYGE_OUTPUT_SUFFIX}_d optimized KFL${KLAYGE_OUTPUT_SUFFIX}
)
IF(KLAYGE_PLATFORM_LINUX)
	SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES}
		dl pthread)
ENDIF()
ADD_DEPENDENCIES(${EXE_NAME} AllInEngine)

TARGET_LINK_LIBRARIES(${EXE_NAME} ${EXTRA_LINKED_LIBRARIES})

ADD_POST_BUILD(${EXE_NAME} "")

INSTALL(TARGETS ${EXE_NAME}
	RUNTIME DESTINATION ${KLAYGE_BIN_DIR}
	LIBRARY DESTINATION ${KLAYGE_BIN_DIR}
	ARCHIVE DESTINATION ${KLAYGE_OUTPUT_DIR}
)

CREATE_PROJECT_USERFILE(KlayGE ${EXE_NAME})

SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES FOLDER "Tests")
